Start training...
Epoch 1 / 5
  0%|          | 0/501 [00:00<?, ?it/s]  0%|          | 1/501 [00:01<08:20,  1.00s/it]  0%|          | 2/501 [00:01<03:58,  2.09it/s]  1%|          | 3/501 [00:01<02:32,  3.27it/s]  1%|          | 4/501 [00:01<01:52,  4.43it/s]
  0%|          | 0/61 [00:00<?, ?it/s][AValidation

  7%|▋         | 4/61 [00:00<00:01, 31.27it/s][A
 13%|█▎        | 8/61 [00:00<00:01, 31.02it/s][A
 20%|█▉        | 12/61 [00:00<00:01, 30.68it/s][A
 26%|██▌       | 16/61 [00:00<00:01, 30.69it/s][A
 33%|███▎      | 20/61 [00:00<00:01, 30.78it/s][A
 39%|███▉      | 24/61 [00:00<00:01, 30.65it/s][A
 46%|████▌     | 28/61 [00:00<00:01, 30.53it/s][A
 52%|█████▏    | 32/61 [00:01<00:00, 30.80it/s][A
 59%|█████▉    | 36/61 [00:01<00:00, 30.97it/s][A
 66%|██████▌   | 40/61 [00:01<00:00, 30.95it/s][A
 72%|███████▏  | 44/61 [00:01<00:00, 30.81it/s][A
 79%|███████▊  | 48/61 [00:01<00:00, 30.99it/s][A
 85%|████████▌ | 52/61 [00:01<00:00, 31.04it/s][A
 92%|█████████▏| 56/61 [00:01<00:00, 30.84it/s][A
 98%|█████████▊| 60/61 [00:01<00:00, 30.85it/s][A100%|██████████| 61/61 [00:01<00:00, 30.83it/s]
validation loss =   1%|          | 5/501 [00:03<07:24,  1.12it/s]tensor(8.9049, device='cuda:3')
  1%|          | 6/501 [00:03<05:09,  1.60it/s]  1%|▏         | 7/501 [00:03<03:44,  2.20it/s]  2%|▏         | 8/501 [00:03<02:48,  2.92it/s]  2%|▏         | 9/501 [00:03<02:11,  3.75it/s]Validation

  0%|          | 0/61 [00:00<?, ?it/s][A
  7%|▋         | 4/61 [00:00<00:01, 31.54it/s][A
 13%|█▎        | 8/61 [00:00<00:01, 31.45it/s][A
 20%|█▉        | 12/61 [00:00<00:01, 31.49it/s][A
 26%|██▌       | 16/61 [00:00<00:01, 31.55it/s][A
 33%|███▎      | 20/61 [00:00<00:01, 31.56it/s][A
 39%|███▉      | 24/61 [00:00<00:01, 31.57it/s][A
 46%|████▌     | 28/61 [00:00<00:01, 31.53it/s][A
 52%|█████▏    | 32/61 [00:01<00:00, 31.59it/s][A
 59%|█████▉    | 36/61 [00:01<00:00, 31.47it/s][A
 66%|██████▌   | 40/61 [00:01<00:00, 31.56it/s][A
 72%|███████▏  | 44/61 [00:01<00:00, 31.49it/s][A
 79%|███████▊  | 48/61 [00:01<00:00, 31.57it/s][A
 85%|████████▌ | 52/61 [00:01<00:00, 31.60it/s][A
 92%|█████████▏| 56/61 [00:01<00:00, 31.55it/s][A
 98%|█████████▊| 60/61 [00:01<00:00, 31.53it/s][A100%|██████████| 61/61 [00:01<00:00, 31.52it/s]
validation loss = tensor(7.3532, device='cuda:3')
  2%|▏         | 10/501 [00:05<06:39,  1.23it/s]  2%|▏         | 11/501 [00:05<04:52,  1.68it/s]  2%|▏         | 12/501 [00:06<03:37,  2.25it/s]  3%|▎         | 13/501 [00:06<02:46,  2.93it/s]  3%|▎         | 14/501 [00:06<02:10,  3.72it/s]
Validation
  0%|          | 0/61 [00:00<?, ?it/s][A
  7%|▋         | 4/61 [00:00<00:01, 30.89it/s][A
 13%|█▎        | 8/61 [00:00<00:01, 31.30it/s][A
 20%|█▉        | 12/61 [00:00<00:01, 31.40it/s][A
 26%|██▌       | 16/61 [00:00<00:01, 31.41it/s][A
 33%|███▎      | 20/61 [00:00<00:01, 31.43it/s][A
 39%|███▉      | 24/61 [00:00<00:01, 31.37it/s][A
 46%|████▌     | 28/61 [00:00<00:01, 31.33it/s][A
 52%|█████▏    | 32/61 [00:01<00:00, 31.30it/s][A
 59%|█████▉    | 36/61 [00:01<00:00, 31.37it/s][A
 66%|██████▌   | 40/61 [00:01<00:00, 31.44it/s][A
 72%|███████▏  | 44/61 [00:01<00:00, 31.45it/s][A
 79%|███████▊  | 48/61 [00:01<00:00, 31.49it/s][A
 85%|████████▌ | 52/61 [00:01<00:00, 31.00it/s][A
 92%|█████████▏| 56/61 [00:01<00:00, 30.98it/s][A
 98%|█████████▊| 60/61 [00:01<00:00, 30.96it/s][A100%|██████████| 61/61 [00:01<00:00, 31.20it/s]
validation loss =   3%|▎         | 15/501 [00:08<06:33,  1.24it/s]tensor(7.2945, device='cuda:3')
  3%|▎         | 16/501 [00:08<04:49,  1.68it/s]  3%|▎         | 17/501 [00:08<03:36,  2.23it/s]  4%|▎         | 18/501 [00:08<02:46,  2.91it/s]  4%|▍         | 19/501 [00:08<02:10,  3.68it/s]
  0%|          | 0/61 [00:00<?, ?it/s][AValidation

  7%|▋         | 4/61 [00:00<00:01, 30.76it/s][A
 13%|█▎        | 8/61 [00:00<00:01, 30.48it/s][A
 20%|█▉        | 12/61 [00:00<00:01, 30.58it/s][A
 26%|██▌       | 16/61 [00:00<00:01, 30.42it/s][A
 33%|███▎      | 20/61 [00:00<00:01, 30.49it/s][A
 39%|███▉      | 24/61 [00:00<00:01, 30.47it/s][A
 46%|████▌     | 28/61 [00:00<00:01, 30.54it/s][A
 52%|█████▏    | 32/61 [00:01<00:00, 30.57it/s][A
 59%|█████▉    | 36/61 [00:01<00:00, 30.84it/s][A
 66%|██████▌   | 40/61 [00:01<00:00, 30.85it/s][A
 72%|███████▏  | 44/61 [00:01<00:00, 30.95it/s][A
 79%|███████▊  | 48/61 [00:01<00:00, 31.08it/s][A
 85%|████████▌ | 52/61 [00:01<00:00, 31.10it/s][A
 92%|█████████▏| 56/61 [00:01<00:00, 31.11it/s][A
 98%|█████████▊| 60/61 [00:01<00:00, 31.09it/s][A100%|██████████| 61/61 [00:01<00:00, 30.81it/s]
validation loss = tensor(7.1827, device='cuda:3')
  4%|▍         | 20/501 [00:10<06:32,  1.23it/s]  4%|▍         | 21/501 [00:10<04:48,  1.66it/s]  4%|▍         | 22/501 [00:11<03:36,  2.21it/s]  5%|▍         | 23/501 [00:11<02:45,  2.88it/s]  5%|▍         | 24/501 [00:11<02:10,  3.66it/s]
Validation
  0%|          | 0/61 [00:00<?, ?it/s][A
  5%|▍         | 3/61 [00:00<00:01, 29.56it/s][A
 11%|█▏        | 7/61 [00:00<00:01, 30.73it/s][A
 18%|█▊        | 11/61 [00:00<00:01, 31.08it/s][A
 25%|██▍       | 15/61 [00:00<00:01, 30.94it/s][A
 31%|███       | 19/61 [00:00<00:01, 30.99it/s][A
 38%|███▊      | 23/61 [00:00<00:01, 30.91it/s][A
 44%|████▍     | 27/61 [00:00<00:01, 30.91it/s][A
 51%|█████     | 31/61 [00:01<00:00, 31.05it/s][A
 57%|█████▋    | 35/61 [00:01<00:00, 31.02it/s][A
 64%|██████▍   | 39/61 [00:01<00:00, 30.69it/s][A
 70%|███████   | 43/61 [00:01<00:00, 29.62it/s][A
 75%|███████▌  | 46/61 [00:01<00:00, 29.08it/s][A
 80%|████████  | 49/61 [00:01<00:00, 25.71it/s][A
 85%|████████▌ | 52/61 [00:01<00:00, 26.58it/s][A
 90%|█████████ | 55/61 [00:01<00:00, 27.13it/s][A
 95%|█████████▌| 58/61 [00:01<00:00, 27.04it/s][A
100%|██████████| 61/61 [00:02<00:00, 26.30it/s][A100%|██████████| 61/61 [00:02<00:00, 28.77it/s]
validation loss = tensor(7.1209, device='cuda:3')
  5%|▍         | 25/501 [00:13<06:51,  1.16it/s]  5%|▌         | 26/501 [00:13<05:02,  1.57it/s]  5%|▌         | 27/501 [00:13<03:51,  2.05it/s]  6%|▌         | 28/501 [00:13<02:59,  2.64it/s]  6%|▌         | 29/501 [00:14<02:31,  3.12it/s]Validation

  0%|          | 0/61 [00:00<?, ?it/s][A
  5%|▍         | 3/61 [00:00<00:02, 25.37it/s][A
 10%|▉         | 6/61 [00:00<00:02, 26.23it/s][A
 15%|█▍        | 9/61 [00:00<00:01, 26.56it/s][A
 20%|█▉        | 12/61 [00:00<00:01, 27.80it/s][A
 25%|██▍       | 15/61 [00:00<00:01, 28.45it/s][A
 30%|██▉       | 18/61 [00:00<00:01, 28.24it/s][A
 34%|███▍      | 21/61 [00:00<00:01, 28.27it/s][A
 39%|███▉      | 24/61 [00:00<00:01, 28.56it/s][A
 44%|████▍     | 27/61 [00:00<00:01, 28.97it/s][A
 49%|████▉     | 30/61 [00:01<00:01, 29.25it/s][A
 54%|█████▍    | 33/61 [00:01<00:00, 28.78it/s][A
 59%|█████▉    | 36/61 [00:01<00:00, 29.05it/s][A
 64%|██████▍   | 39/61 [00:01<00:00, 29.22it/s][A
 69%|██████▉   | 42/61 [00:01<00:00, 29.37it/s][A
 74%|███████▍  | 45/61 [00:01<00:00, 29.21it/s][A
 79%|███████▊  | 48/61 [00:01<00:00, 28.97it/s][A
 84%|████████▎ | 51/61 [00:01<00:00, 29.14it/s][A
 89%|████████▊ | 54/61 [00:01<00:00, 29.05it/s][A
 93%|█████████▎| 57/61 [00:02<00:00, 26.24it/s][A
 98%|█████████▊| 60/61 [00:02<00:00, 25.29it/s][A100%|██████████| 61/61 [00:02<00:00, 27.80it/s]
validation loss = tensor(7.0573, device='cuda:3')
  6%|▌         | 30/501 [00:16<07:15,  1.08it/s]  6%|▌         | 31/501 [00:16<05:20,  1.47it/s]  6%|▋         | 32/501 [00:16<04:05,  1.91it/s]  7%|▋         | 33/501 [00:16<03:09,  2.47it/s]  7%|▋         | 34/501 [00:16<02:32,  3.07it/s]Validation

  0%|          | 0/61 [00:00<?, ?it/s][A
  5%|▍         | 3/61 [00:00<00:01, 29.07it/s][A
 10%|▉         | 6/61 [00:00<00:01, 29.30it/s][A
 15%|█▍        | 9/61 [00:00<00:01, 28.57it/s][A
 20%|█▉        | 12/61 [00:00<00:01, 24.66it/s][A
 25%|██▍       | 15/61 [00:00<00:01, 26.15it/s][A
 30%|██▉       | 18/61 [00:00<00:01, 25.00it/s][A
 34%|███▍      | 21/61 [00:00<00:01, 21.94it/s][A
 39%|███▉      | 24/61 [00:00<00:01, 23.32it/s][A
 44%|████▍     | 27/61 [00:01<00:01, 23.67it/s][A
 49%|████▉     | 30/61 [00:01<00:01, 24.29it/s][A
 54%|█████▍    | 33/61 [00:01<00:01, 24.84it/s][A
 59%|█████▉    | 36/61 [00:01<00:01, 23.85it/s][A
 64%|██████▍   | 39/61 [00:01<00:00, 24.19it/s][A
 69%|██████▉   | 42/61 [00:01<00:00, 23.36it/s][A
 74%|███████▍  | 45/61 [00:01<00:00, 22.52it/s][A
 79%|███████▊  | 48/61 [00:02<00:00, 19.58it/s][A
 84%|████████▎ | 51/61 [00:02<00:00, 20.63it/s][A
 89%|████████▊ | 54/61 [00:02<00:00, 18.52it/s][A
 93%|█████████▎| 57/61 [00:02<00:00, 20.46it/s][A
 98%|█████████▊| 60/61 [00:02<00:00, 22.40it/s][A100%|██████████| 61/61 [00:02<00:00, 23.05it/s]
validation loss = tensor(6.9845, device='cuda:3')
  7%|▋         | 35/501 [00:19<08:13,  1.06s/it]  7%|▋         | 36/501 [00:19<06:01,  1.28it/s]  7%|▋         | 37/501 [00:19<04:29,  1.72it/s]  8%|▊         | 38/501 [00:20<03:25,  2.25it/s]  8%|▊         | 39/501 [00:20<02:38,  2.92it/s]Validation

  0%|          | 0/61 [00:00<?, ?it/s][A
  5%|▍         | 3/61 [00:00<00:01, 29.32it/s][A
 10%|▉         | 6/61 [00:00<00:02, 25.07it/s][A
 15%|█▍        | 9/61 [00:00<00:01, 26.13it/s][A
 20%|█▉        | 12/61 [00:00<00:01, 24.60it/s][A
 25%|██▍       | 15/61 [00:00<00:01, 26.05it/s][A
 30%|██▉       | 18/61 [00:00<00:01, 25.34it/s][A
 34%|███▍      | 21/61 [00:00<00:01, 26.24it/s][A
 39%|███▉      | 24/61 [00:00<00:01, 26.81it/s][A
 44%|████▍     | 27/61 [00:01<00:01, 24.94it/s][A
 49%|████▉     | 30/61 [00:01<00:01, 24.99it/s][A
 54%|█████▍    | 33/61 [00:01<00:01, 25.65it/s][A
 59%|█████▉    | 36/61 [00:01<00:01, 23.84it/s][A
 64%|██████▍   | 39/61 [00:01<00:00, 24.75it/s][A
 69%|██████▉   | 42/61 [00:01<00:00, 23.08it/s][A
 74%|███████▍  | 45/61 [00:01<00:00, 23.98it/s][A
 79%|███████▊  | 48/61 [00:01<00:00, 24.50it/s][A
 84%|████████▎ | 51/61 [00:02<00:00, 25.58it/s][A
 89%|████████▊ | 54/61 [00:02<00:00, 25.90it/s][A
 93%|█████████▎| 57/61 [00:02<00:00, 26.54it/s][A
 98%|█████████▊| 60/61 [00:02<00:00, 26.96it/s][A100%|██████████| 61/61 [00:02<00:00, 25.40it/s]
validation loss = tensor(6.9177, device='cuda:3')
  8%|▊         | 40/501 [00:22<07:39,  1.00it/s]  8%|▊         | 41/501 [00:22<05:36,  1.37it/s]  8%|▊         | 42/501 [00:22<04:12,  1.82it/s]  9%|▊         | 43/501 [00:23<03:13,  2.37it/s]  9%|▉         | 44/501 [00:23<02:31,  3.02it/s]Validation

  0%|          | 0/61 [00:00<?, ?it/s][A
  5%|▍         | 3/61 [00:00<00:02, 24.56it/s][A
 10%|▉         | 6/61 [00:00<00:02, 20.70it/s][A
 15%|█▍        | 9/61 [00:00<00:02, 22.44it/s][A
 20%|█▉        | 12/61 [00:00<00:02, 22.16it/s][A
 25%|██▍       | 15/61 [00:00<00:01, 23.17it/s][A
 30%|██▉       | 18/61 [00:00<00:01, 24.89it/s][A
 34%|███▍      | 21/61 [00:00<00:01, 25.56it/s][A
 39%|███▉      | 24/61 [00:00<00:01, 26.44it/s][A
 44%|████▍     | 27/61 [00:01<00:01, 23.66it/s][A
 49%|████▉     | 30/61 [00:01<00:01, 22.33it/s][A
 54%|█████▍    | 33/61 [00:01<00:01, 22.45it/s][A
 59%|█████▉    | 36/61 [00:01<00:01, 21.55it/s][A
 64%|██████▍   | 39/61 [00:01<00:00, 23.56it/s][A
 69%|██████▉   | 42/61 [00:01<00:00, 24.83it/s][A
 74%|███████▍  | 45/61 [00:01<00:00, 25.61it/s][A
 79%|███████▊  | 48/61 [00:01<00:00, 26.58it/s][A
 84%|████████▎ | 51/61 [00:02<00:00, 26.57it/s][A
 89%|████████▊ | 54/61 [00:02<00:00, 23.69it/s][A
 93%|█████████▎| 57/61 [00:02<00:00, 22.49it/s][A
 98%|█████████▊| 60/61 [00:02<00:00, 21.97it/s][A100%|██████████| 61/61 [00:02<00:00, 23.56it/s]
validation loss = tensor(6.8540, device='cuda:3')
  9%|▉         | 45/501 [00:25<08:03,  1.06s/it]  9%|▉         | 46/501 [00:26<05:57,  1.27it/s]  9%|▉         | 47/501 [00:26<04:25,  1.71it/s] 10%|▉         | 48/501 [00:26<03:20,  2.26it/s] 10%|▉         | 48/501 [00:26<04:08,  1.83it/s]
Traceback (most recent call last):
  File "/usr/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/usr/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/dmivilensky/Diffusion-LM/scripts/train_diffusion_lm.py", line 91, in <module>
    true_loss = diffusion.training_losses(model, batch, t, model_kwargs=micro_cond)["loss"]
  File "/home/dmivilensky/Diffusion-LM/src/model_utils.py", line 40, in training_losses
    return super().training_losses(self._wrap_model(model), *args, **kwargs)
  File "/home/dmivilensky/Diffusion-LM/src/gaussian_diffusion.py", line 94, in training_losses
    return self.training_losses_e2e(model, *args, **kwargs)
  File "/home/dmivilensky/Diffusion-LM/src/gaussian_diffusion.py", line 782, in training_losses_e2e
    model_output = model(x_t, self._scale_timesteps(t), **model_kwargs)
  File "/home/dmivilensky/Diffusion-LM/src/model_utils.py", line 65, in __call__
    return self.model(x, new_ts, **kwargs)
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/dmivilensky/Diffusion-LM/src/transformer.py", line 107, in forward
    input_trans_hidden_states = self.input_transformers(emb_inputs).last_hidden_state
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 568, in forward
    layer_outputs = layer_module(
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 496, in forward
    layer_output = apply_chunking_to_forward(
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1995, in apply_chunking_to_forward
    return forward_fn(*input_tensors)
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 508, in feed_forward_chunk
    intermediate_output = self.intermediate(attention_output)
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/transformers/models/bert/modeling_bert.py", line 411, in forward
    hidden_states = self.dense(hidden_states)
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl
    return forward_call(*input, **kwargs)
  File "/home/dmivilensky/.local/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
KeyboardInterrupt
